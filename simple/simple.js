(()=>{var v=(m,l)=>{let o=document.createElement("template");o.innerHTML=m;let p=o.content.firstElementChild;return p.classList.add(l),()=>p.cloneNode(!0)},I=m=>{let l,o,p="elab-popup-dropup",P="elab-popup-dropdown",E="data-value",r="data-selected",f="data-disabled",h="data-selected-all",x="data-placeholder",b=".elab",a="input[type=checkbox]",T=".elab-popup-item",S=v(m.popupTemplate,"elab-popup"),k=v(m.popupItemTemplate,"elab-popup-item"),M=e=>e?.nextElementSibling,O=e=>e?.previousElementSibling,y=e=>{let n=[];for(let t of e.firstElementChild.children){let c=t.getAttribute(E);c&&t.hasAttribute(r)&&n.push(c)}return n},C=(e,n)=>{let t=n.querySelectorAll(`[${r}]`).length;e.checked=t!==0,e.indeterminate=t!==n.querySelectorAll(`[${E}]:not([${f}])`).length},g=()=>{if(l&&o){let e=l.getBoundingClientRect();o.style.left=l.offsetLeft+"px",o.style.width=l.offsetWidth+"px",o.classList.contains(p)?(o.style.maxHeight=e.top-8+"px",o.style.top=l.offsetTop-o.offsetHeight+"px"):(o.style.maxHeight=window.innerHeight-e.bottom-20+"px",o.style.top=l.offsetTop+l.offsetHeight+"px")}},u=()=>{l&&!l.dispatchEvent(new CustomEvent("close",{bubbles:!0,cancelable:!0,detail:{values:y(l)}}))||(l?.focus(),o?.remove(),l=o=void 0)},w=e=>e.target.closest(T)?.querySelector(a)?.focus(),R=e=>{let n=e.currentTarget,t=e.target,c=t.matches(a)&&l?.firstElementChild.children[[...n.children].indexOf(t.closest(T))];if(!!c){if(c.hasAttribute(h)){for(let s of l.firstElementChild.children)s.hasAttribute(E)&&!s.hasAttribute(f)&&s.toggleAttribute(r,t.checked);for(let s of n.querySelectorAll(a))s!==t&&!s.disabled&&(s.checked=t.checked)}else{c.toggleAttribute(r,t.checked);let s=n.querySelector(`[${h}] ${a}`);s&&C(s,l)}g(),l.dispatchEvent(new CustomEvent("change",{bubbles:!0,detail:{values:y(l)}})),e.stopPropagation()}},_=e=>{let n=e.target;if(!n.matches(a))return;let t=e.keyCode;if(t===38||t===40){e.preventDefault();let c=t===38?O:M;for(let s=c(n.closest(T));s;s=c(s)){let i=s.querySelector(a);if(!i?.disabled){i?.focus();break}}}},L=e=>{if(l===e)return;l&&u();let n=e.getBoundingClientRect(),t=S(),c=t.querySelector("slot"),s=c.parentElement;c.remove();for(let i of e.firstElementChild.cloneNode(!0).children){if(i.hasAttribute(x))continue;let A=s.appendChild(k());for(let H of i.getAttributeNames())A.setAttribute(H,i.getAttribute(H));let d=A.querySelector(a);d&&(i.hasAttribute(h)?C(d,e):(d.value=i.getAttribute(E),d.checked=i.hasAttribute(r),d.disabled=i.hasAttribute(f))),A.getElementsByTagName("slot")[0]?.replaceWith(...i.childNodes)}t.addEventListener("pointerover",w),t.addEventListener("change",R),t.addEventListener("keydown",_),o=e.parentElement.insertBefore(t,e),l=e,o.classList.add(n.top*1.75>window.innerHeight&&n.bottom+o.offsetHeight>window.innerHeight?p:P),g(),o.style.left=n.left+"px",o.style.width=n.width+"px",setTimeout(()=>o?.getElementsByTagName("input")[0]?.focus())};addEventListener("resize",g),addEventListener("pointerdown",e=>{let n=e.target,t=n.closest(b);t?t===l?u():L(t):o&&!o.contains(n)&&u()}),addEventListener("keydown",e=>{let n=e.target,t=e.keyCode;t===32&&n.matches(b)?(e.preventDefault(),n===o?u():L(n)):(t===38||t===40)&&n.matches(b)?(e.preventDefault(),L(n)):t===27&&o&&(e.preventDefault(),u())})};I({popupTemplate:"<ul><slot></slot></ul>",popupItemTemplate:"<li><label class=elab-label><input class=elab-checkbox type=checkbox><div class=elab-content><slot></slot></div></label></li>"});})();
