import{mdiCheckboxBlankOffOutline as D,mdiCheckboxBlankOutline as N,mdiCheckboxMarked as U,mdiMinusBox as q}from"@mdi/js";import"ripplet.js/es/ripplet-declarative";var C=(p,l)=>{let m=document.createElement("template");m.innerHTML=p;let u=m.content.firstElementChild;return u.classList.add(l),()=>u.cloneNode(!0)},A=p=>p.map(l=>l.checkbox.checked&&l.barItem.getAttribute("data-value")).filter(Boolean),P=p=>{let l,m="elab-open",u="elab-popup-dropup",S="elab-popup-dropdown",T="data-selected",M="data-disabled",O="data-selected-all",B="data-placeholder",L=".elab",b="input[type=checkbox]",y=".elab-popup-item",R=C(p.popupTemplate,"elab-popup"),w=C(p.popupItemTemplate,"elab-popup-item"),x=(e,o)=>{e.checkbox.disabled||(e.checkbox.checked=o,e.barItem.toggleAttribute(T,o),e.popupItem.toggleAttribute(T,o))},I=(e,o)=>{if(e){let t=o.every(({checkbox:s})=>s.disabled||!s.checked);e.checkbox.checked=!t,e.checkbox.indeterminate=!t&&!o.every(({checkbox:s})=>s.disabled||s.checked)}},g=(e,o)=>{let t=o.getBoundingClientRect();e.style.left=t.left+"px",e.style.width=t.width+"px",e.classList.contains(u)?(e.style.maxHeight=t.top-8+"px",e.style.top=t.top-e.offsetHeight+"px"):(e.style.maxHeight=window.innerHeight-t.bottom-20+"px",e.style.top=t.top+o.offsetHeight+"px")},E=()=>{l?.bar.dispatchEvent(new CustomEvent("close",{bubbles:!0,cancelable:!0,detail:{values:A(l.items)}}))&&(l.bar.classList.remove(m),l.bar.focus(),l.popup.remove(),l=void 0)},_=(e,o)=>{let t=[],s;for(let n of e.firstElementChild.children){if(n.hasAttribute(B))continue;let i=o.appendChild(w());for(let a of n.getAttributeNames())i.setAttribute(a,n.getAttribute(a));i.querySelector("slot").replaceWith(...n.cloneNode(!0).childNodes);let d=i.querySelector(b);d&&(n.hasAttribute(O)?s={barItem:n,popupItem:i,checkbox:d}:(d.checked=n.hasAttribute(T),d.disabled=n.hasAttribute(M),t.push({barItem:n,popupItem:i,checkbox:d})))}return I(s,t),[t,s]},k=e=>{if(l?.bar===e)return;l&&E();let o=e.getBoundingClientRect(),t=R(),s=t.querySelector("slot"),[n,i]=_(e,s.parentElement);s.remove(),l={bar:e,popup:t,items:n,itemSelectedAll:i},e.classList.add(m),t.className=(t.className+" "+(e.getAttribute("data-popup-class")||"")).trim(),t.style.cssText=e.getAttribute("data-popup-style")||"",e.parentElement.insertBefore(t,e),t.classList.add(o.top*1.75>window.innerHeight&&o.bottom+t.offsetHeight>window.innerHeight?u:S),g(t,e);let d=(a,c)=>{if(a===i?.checkbox){for(let r of n)x(r,c);i.checkbox.checked=c,i.checkbox.indeterminate=!1}else{let r=n.find(h=>h.checkbox===a);if(!r)return;x(r,c),I(i,n)}g(t,e),e.dispatchEvent(new CustomEvent("change",{bubbles:!0,detail:{values:A(n)}}))};t.addEventListener("pointerover",a=>a.target.closest(y)?.querySelector(b)?.focus()),t.addEventListener("change",a=>{let c=a.target;c.matches(b)&&(d(c,c.checked),a.stopPropagation())}),t.addEventListener("keydown",a=>{let c=a.target;if(!c.matches(b))return;let r=a.keyCode;if(r===38||r===40){a.preventDefault();let h=r===38?"previousElementSibling":"nextElementSibling";for(let f=c.closest(y)?.[h];f;f=f[h]){let v=f.querySelector(b);if(!v?.disabled){v?.focus();break}}}else r===13&&(a.preventDefault(),d(c,!c.checked))}),setTimeout(()=>t.getElementsByTagName("input")[0]?.focus()),p.onOpen?.(l)},H=()=>l&&g(l.popup,l.bar);addEventListener("resize",H),addEventListener("scroll",H,!0),addEventListener("pointerdown",e=>{let o=e.target,t=o.closest(L);t?t===l?.bar?E():k(t):l&&(l.popup.contains(o)?e.preventDefault():E())}),addEventListener("keydown",e=>{let o=e.target,t=e.keyCode;t===27&&l?(e.preventDefault(),E()):t===32&&o.matches(L)?(e.preventDefault(),o===l?.popup?E():k(o)):(t===38||t===40)&&o.matches(L)&&(e.preventDefault(),k(o))})};P({popupTemplate:"<ul><slot></slot></ul>",popupItemTemplate:`<li><label class=elab-label data-ripplet="append-to:parent;color:var(--elab-color);">
<div class=elab-label-background></div>
<input class=elab-checkbox type=checkbox>
<svg class=elab-checkbox-icon viewBox="0 0 24 24" data-ripplet="append-to:parent;opacity:.2;centered:true;">
  <path class=elab-checkbox-icon-unchecked d="${N}" />
  <path class=elab-checkbox-icon-disabled d="${D}" />
  <path class=elab-checkbox-icon-checked d="${U}" />
  <path class=elab-checkbox-icon-indeterminate d="${q}" />
</svg>
<div class=elab-content><slot></slot></div>
</label></li>`,onOpen:({bar:p,popup:l})=>l.style.setProperty("--elab-color",getComputedStyle(p).getPropertyValue("--elab-color"))});
