import{mdiCheckboxBlankOffOutline as _,mdiCheckboxBlankOutline as D,mdiCheckboxMarked as N,mdiMinusBox as U}from"@mdi/js";var C=(p,o)=>{let m=document.createElement("template");m.innerHTML=p;let u=m.content.firstElementChild;return u.classList.add(o),()=>u.cloneNode(!0)},v=p=>p.map(o=>o.checkbox.checked&&o.barItem.getAttribute("data-value")).filter(Boolean),A=p=>{let o,m="elab-open",u="elab-popup-dropup",P="elab-popup-dropdown",L="data-selected",M="data-disabled",S="data-selected-all",O="data-placeholder",g=".elab",b="input[type=checkbox]",y=".elab-popup-item",B=C(p.popupTemplate,"elab-popup"),R=C(p.popupItemTemplate,"elab-popup-item"),x=(e,l)=>{e.checkbox.disabled||(e.checkbox.checked=l,e.barItem.toggleAttribute(L,l),e.popupItem.toggleAttribute(L,l))},I=(e,l)=>{if(e){let t=l.every(({checkbox:s})=>s.disabled||!s.checked);e.checkbox.checked=!t,e.checkbox.indeterminate=!t&&!l.every(({checkbox:s})=>s.disabled||s.checked)}},h=(e,l)=>{let t=l.getBoundingClientRect();e.style.left=t.left+"px",e.style.width=t.width+"px",e.classList.contains(u)?(e.style.maxHeight=t.top-8+"px",e.style.top=t.top-e.offsetHeight+"px"):(e.style.maxHeight=window.innerHeight-t.bottom-20+"px",e.style.top=t.top+l.offsetHeight+"px")},E=()=>{o?.bar.dispatchEvent(new CustomEvent("close",{bubbles:!0,cancelable:!0,detail:{values:v(o.items)}}))&&(o.bar.classList.remove(m),o.bar.focus(),o.popup.remove(),o=void 0)},w=(e,l)=>{let t=[],s;for(let n of e.firstElementChild.children){if(n.hasAttribute(O))continue;let i=l.appendChild(R());for(let a of n.getAttributeNames())i.setAttribute(a,n.getAttribute(a));i.querySelector("slot").replaceWith(...n.cloneNode(!0).childNodes);let d=i.querySelector(b);d&&(n.hasAttribute(S)?s={barItem:n,popupItem:i,checkbox:d}:(d.checked=n.hasAttribute(L),d.disabled=n.hasAttribute(M),t.push({barItem:n,popupItem:i,checkbox:d})))}return I(s,t),[t,s]},k=e=>{if(o?.bar===e)return;o&&E();let l=e.getBoundingClientRect(),t=B(),s=t.querySelector("slot"),[n,i]=w(e,s.parentElement);s.remove(),o={bar:e,popup:t,items:n,itemSelectedAll:i},e.classList.add(m),t.className=(t.className+" "+(e.getAttribute("data-popup-class")||"")).trim(),t.style.cssText=e.getAttribute("data-popup-style")||"",document.body.appendChild(t),t.classList.add(l.top*1.75>window.innerHeight&&l.bottom+t.offsetHeight>window.innerHeight?u:P),h(t,e);let d=(a,c)=>{if(a===i?.checkbox){for(let r of n)x(r,c);i.checkbox.checked=c,i.checkbox.indeterminate=!1}else{let r=n.find(f=>f.checkbox===a);if(!r)return;x(r,c),I(i,n)}h(t,e),e.dispatchEvent(new CustomEvent("change",{bubbles:!0,detail:{values:v(n)}}))};t.addEventListener("pointerover",a=>a.target.closest(y)?.querySelector(b)?.focus()),t.addEventListener("change",a=>{let c=a.target;c.matches(b)&&(d(c,c.checked),a.stopPropagation())}),t.addEventListener("keydown",a=>{let c=a.target;if(!c.matches(b))return;let r=a.keyCode;if(r===38||r===40){a.preventDefault();let f=r===38?"previousElementSibling":"nextElementSibling";for(let T=c.closest(y)?.[f];T;T=T[f]){let H=T.querySelector(b);if(!H?.disabled){H?.focus();break}}}else r===13&&(a.preventDefault(),d(c,!c.checked))}),setTimeout(()=>t.getElementsByTagName("input")[0]?.focus()),p.onOpen?.(o)};addEventListener("resize",()=>o&&h(o.popup,o.bar)),addEventListener("scroll",()=>o&&h(o.popup,o.bar)),addEventListener("pointerdown",e=>{let l=e.target,t=l.closest(g);t?t===o?.bar?E():k(t):o&&(o.popup.contains(l)?e.preventDefault():E())}),addEventListener("keydown",e=>{let l=e.target,t=e.keyCode;t===27&&o?(e.preventDefault(),E()):t===32&&l.matches(g)?(e.preventDefault(),l===o?.popup?E():k(l)):(t===38||t===40)&&l.matches(g)&&(e.preventDefault(),k(l))})};A({popupTemplate:"<ul><slot></slot></ul>",popupItemTemplate:`<li><label class=elab-label data-ripplet="append-to:parent;color:var(--elab-color);">
<div class=elab-label-background></div>
<input class=elab-checkbox type=checkbox>
<svg class=elab-checkbox-icon viewBox="0 0 24 24" data-ripplet="append-to:parent;opacity:.2;centered:true;">
  <path class=elab-checkbox-icon-unchecked d="${D}" />
  <path class=elab-checkbox-icon-disabled d="${_}" />
  <path class=elab-checkbox-icon-checked d="${N}" />
  <path class=elab-checkbox-icon-indeterminate d="${U}" />
</svg>
<div class=elab-content><slot></slot></div>
</label></li>`,onOpen:({bar:p,popup:o})=>o.style.setProperty("--elab-color",getComputedStyle(p).getPropertyValue("--elab-color"))});
